<!DOCTYPE html>


<html>

<head>

<meta name="viewport" content="width=device-width, initial-scale=0.86, maximum-scale=3.0, minimum-scale=0.86">
<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css"/>
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>

<style>
           
body {
    font-family: monospace;
    font-size: medium;
}
table {
    font-family: monospace;
    font-size: medium;
    border-spacing: 1px;
    border-collapse: collapse;
}
th, td {
    text-align: center;
    white-space: nowrap;
    padding: 3px;
}
th.alleleName, td.alleleName {
    text-align: left;
}
th.hvrId {
    text-align: center;
    border-left: 1px solid black;
}
th.variantId, th.variantSeq, th.recipientEpitope,
th.pctBeadsPositive, th.antibodyPresent, th.knownReactiveEpitope {
    text-align: center;
    border: 1px solid black;
}
td.variantId {
    text-align: center;
    border-left: 1px solid black;
}
th.index, td.index {
    border-left: 3px solid black;
}
th.indexRight, td.indexRight {
    border-right: 3px solid black;
}
a.filterEnabled {
    background-color: yellow;
}
#reportTable tbody tr {
    border-bottom: 1px solid transparent;
}
#reportTable tbody tr:hover {
    background-color: yellow;
    border-bottom: 1px solid black;
}   
#reportTable td.mismatch, #reportTable th.mismatch {
    background-color: yellow;
}
table.statusDescriptionTable td {
    text-align: left;
    border: 1px solid black;
}

</style>

<title>HLA-DPB1 Compatibility Report</title>
        
</head>

<body>

    <div id="working" style="position: fixed; top: 0px; width: 150px; left: 50%; margin-left: -75px; text-align: center; background-color: red; color: white; font-weight: bold;">working...</div>

    <h1>HLA-DPB1 Compatibility Report (<a href="https://github.com/ghsmith/hladpb1/blob/master/hladpb1-webServices/src/main/webapp/ajaxCompatibilityReportPaginated.html">source code</a>)</h1>
    
    <p>
        This is the paginated version of the report. An <a href="/hladpb1/ajaxCompatibilityReport.html">unpaginated version</a>
        is also available, but may perform slowly on some clients.
    </p>
    <p>
        Select recipient antibodies and donor & recipient alleles below. An
        antibody for a hypervariable region epitope is inferred when (a) all
        single antigen beads with that epitope are positive and (b) the epitope
        is not present on any of the recipient's alleles. Each donor allele will
        be evaluated for compatibility with the recipient and assigned a
        compatibility status:
    </p>
    <p>
        <table class="statusDescriptionTable">
            <tr><td>NEI</td><td>not&nbsp;electronically&nbsp;incompatible</td><td>the single antigen bead (SAB) corresponding to the donor allele is NOT positive and antibody specificity for an epitope of the donor allele is NOT inferred</td></tr>
            <tr><td>EI</td><td>electronically&nbsp;incompatible</i></td><td>antibody specificity for an epitope of the donor allele is inferred</td></tr>
            <tr><td>I</td><td>incompatible</i></td><td>the single antigen bead corresponding to the donor allele is positive</td></tr>
            <tr><td>AA</td><td>auto-antibody</td><td>the single antigen bead is positive, but is also a recipient allele</td></tr>
        </table>
    </p>
    <p>
        Selection of antibodies to alleles that are not the subject of a single
        antigen bead is currently not allowed. Hypervariable region variants
        that are not associated with a variant ID (i.e., appear in the <i>n/a</i>
        column below), are currently not considered when assigning a
        compatibility status.
    </p>
    <p>
        The IMGT allele database version is <span id="imgtDbVersion">...</span>
        and the single antigen bead (SAB) reagent lot number is
        <span id="reagentLotNumber">...</span>. The session ID is
        <span id="sessionId">...</span>
        (<a id="resetSessionLink" href="javascript:void(0);">reset session</a>).
    </p>
    <p>
        This report is for research use only.
    </p>

    <div style="margin-top: 10px; margin-bottom: 10px; border: 1px solid black; width: 100%; background-color: lightgray;">
        <table style="width: 100%;"><tr>
            <td style="text-align: left; white-space: nowrap;"><a id="linkPrevPage" href="javascript:void(0)">&Longleftarrow; previous page<a></td>
            <td style="text-align: center; white-space: nowrap;">
                page number:<select id="selectPage"></select>
                (size:<input type="text" id="inputPageSize" size="4">)
            <td>
            <td style="text-align: right; white-space: nowrap;"><a id="linkNextPage" href="javascript:void(0)">next page &Longrightarrow;<a></td>
        </tr></table>
    </div>
    
    <table id="reportTable">
        <thead>
            <tr>
                <th class="alleleName">[<a id="alleleNameSort" href="javascript:void(0);">sort</a>]</th>
                <th>[<a id="sabFilter" href="javascript:void(0);">filter=Y</a>]</th>
                <th colspan="3" style="border-bottom: 1px solid black;">[<a id="selectedFilter" href="javascript:void(0);">filter=Y</a>]</th>
                <th>[<a id="statusSort" href="javascript:void(0);">sort</a>]</th>
                <th colspan="49" style="border-bottom: 1px solid black;">hypervariable region name</th>
            </tr>
            <tr id="columnNames">
                <th data-name="allele.alleleName" class="alleleName">allele name</th>
                <th data-name="allele.singleAntigenBead ? 'Y' : '&nbsp;'">SAB</th>
                <th data-name="allele.donorTypeForCompat" data-label="D">donor<br/>type<br/>(D)</th>
                <th data-name="allele.recipientTypeForCompat" data-label="R">recip<br/>type<br/>(R)</th>
                <th data-name="allele.recipientAntibodyForCompat" data-label="Ab">recip<br/>antib<br/>(Ab)</th>
                <th data-name="allele.compatInterpretation">status</th>
                <th colspan="7" data-hvr-id="a" class="hvrId index">a</th>
                <th colspan="7" data-hvr-id="b" class="hvrId index">b</th>
                <th colspan="7" data-hvr-id="c" class="hvrId index">c</th>
                <th colspan="7" data-hvr-id="d" class="hvrId index">d</th>
                <th colspan="7" data-hvr-id="e" class="hvrId index">e</th>
                <th colspan="7" data-hvr-id="f" class="hvrId index">f</th>
                <th colspan="7" data-hvr-id="g" class="hvrId index indexRight">g</th>
            </tr>
            <!-- Set up for a maximum of 7 hypervariable region variants per
                 hypervariable region. This is reasonable to start with. -->
            <tr id="hvrVariantIds" style="border: 1px solid black;">
                <th colspan="6" style="text-align: right;">hypervariable region variant ID &Longrightarrow;</th>
                <th data-name="allele.hvrVariantMap['a'] != undefined && 1 == allele.hvrVariantMap['a'].variantId ? 1 : '&nbsp;'" data-hvr-id="a" class="variantId index">1</th><th data-name="allele.hvrVariantMap['a'] != undefined && 2 == allele.hvrVariantMap['a'].variantId ? 2 : '&nbsp;'" data-hvr-id="a" class="variantId ">2</th><th data-name="allele.hvrVariantMap['a'] != undefined && 3 == allele.hvrVariantMap['a'].variantId ? 3 : '&nbsp;'" data-hvr-id="a" class="variantId ">3</th><th data-name="allele.hvrVariantMap['a'] != undefined && 4 == allele.hvrVariantMap['a'].variantId ? 4 : '&nbsp;'" data-hvr-id="a" class="variantId ">4</th><th data-name="allele.hvrVariantMap['a'] != undefined && 5 == allele.hvrVariantMap['a'].variantId ? 5 : '&nbsp;'" data-hvr-id="a" class="variantId ">5</th><th data-name="allele.hvrVariantMap['a'] != undefined && 6 == allele.hvrVariantMap['a'].variantId ? 6 : '&nbsp;'" data-hvr-id="a" class="variantId ">6</th>
                    <th data-name="allele.hvrVariantMap['a'] != undefined && allele.hvrVariantMap['a'].variantId.match(/[A-Z]+/) ? allele.hvrVariantMap['a'].variantId : '&nbsp;'" data-hvr-id="a" class="variantId indexRight">n/a</th>
                <th data-name="allele.hvrVariantMap['b'] != undefined && 1 == allele.hvrVariantMap['b'].variantId ? 1 : '&nbsp;'" data-hvr-id="b" class="variantId index">1</th><th data-name="allele.hvrVariantMap['b'] != undefined && 2 == allele.hvrVariantMap['b'].variantId ? 2 : '&nbsp;'" data-hvr-id="b" class="variantId ">2</th><th data-name="allele.hvrVariantMap['b'] != undefined && 3 == allele.hvrVariantMap['b'].variantId ? 3 : '&nbsp;'" data-hvr-id="b" class="variantId ">3</th><th data-name="allele.hvrVariantMap['b'] != undefined && 4 == allele.hvrVariantMap['b'].variantId ? 4 : '&nbsp;'" data-hvr-id="b" class="variantId ">4</th><th data-name="allele.hvrVariantMap['b'] != undefined && 5 == allele.hvrVariantMap['b'].variantId ? 5 : '&nbsp;'" data-hvr-id="b" class="variantId ">5</th><th data-name="allele.hvrVariantMap['b'] != undefined && 6 == allele.hvrVariantMap['b'].variantId ? 6 : '&nbsp;'" data-hvr-id="b" class="variantId ">6</th>
                    <th data-name="allele.hvrVariantMap['b'] != undefined && allele.hvrVariantMap['b'].variantId.match(/[A-Z]+/) ? allele.hvrVariantMap['b'].variantId : '&nbsp;'" data-hvr-id="b" class="variantId indexRight"}">n/a</th>
                <th data-name="allele.hvrVariantMap['c'] != undefined && 1 == allele.hvrVariantMap['c'].variantId ? 1 : '&nbsp;'" data-hvr-id="c" class="variantId index">1</th><th data-name="allele.hvrVariantMap['c'] != undefined && 2 == allele.hvrVariantMap['c'].variantId ? 2 : '&nbsp;'" data-hvr-id="c" class="variantId ">2</th><th data-name="allele.hvrVariantMap['c'] != undefined && 3 == allele.hvrVariantMap['c'].variantId ? 3 : '&nbsp;'" data-hvr-id="c" class="variantId ">3</th><th data-name="allele.hvrVariantMap['c'] != undefined && 4 == allele.hvrVariantMap['c'].variantId ? 4 : '&nbsp;'" data-hvr-id="c" class="variantId ">4</th><th data-name="allele.hvrVariantMap['c'] != undefined && 5 == allele.hvrVariantMap['c'].variantId ? 5 : '&nbsp;'" data-hvr-id="c" class="variantId ">5</th><th data-name="allele.hvrVariantMap['c'] != undefined && 6 == allele.hvrVariantMap['c'].variantId ? 6 : '&nbsp;'" data-hvr-id="c" class="variantId ">6</th>
                    <th data-name="allele.hvrVariantMap['c'] != undefined && allele.hvrVariantMap['c'].variantId.match(/[A-Z]+/) ? allele.hvrVariantMap['c'].variantId : '&nbsp;'" data-hvr-id="c" class="variantId indexRight"}">n/a</th>
                <th data-name="allele.hvrVariantMap['d'] != undefined && 1 == allele.hvrVariantMap['d'].variantId ? 1 : '&nbsp;'" data-hvr-id="d" class="variantId index">1</th><th data-name="allele.hvrVariantMap['d'] != undefined && 2 == allele.hvrVariantMap['d'].variantId ? 2 : '&nbsp;'" data-hvr-id="d" class="variantId ">2</th><th data-name="allele.hvrVariantMap['d'] != undefined && 3 == allele.hvrVariantMap['d'].variantId ? 3 : '&nbsp;'" data-hvr-id="d" class="variantId ">3</th><th data-name="allele.hvrVariantMap['d'] != undefined && 4 == allele.hvrVariantMap['d'].variantId ? 4 : '&nbsp;'" data-hvr-id="d" class="variantId ">4</th><th data-name="allele.hvrVariantMap['d'] != undefined && 5 == allele.hvrVariantMap['d'].variantId ? 5 : '&nbsp;'" data-hvr-id="d" class="variantId ">5</th><th data-name="allele.hvrVariantMap['d'] != undefined && 6 == allele.hvrVariantMap['d'].variantId ? 6 : '&nbsp;'" data-hvr-id="d" class="variantId ">6</th>
                    <th data-name="allele.hvrVariantMap['d'] != undefined && allele.hvrVariantMap['d'].variantId.match(/[A-Z]+/) ? allele.hvrVariantMap['d'].variantId : '&nbsp;'" data-hvr-id="d" class="variantId indexRight"}">n/a</th>
                <th data-name="allele.hvrVariantMap['e'] != undefined && 1 == allele.hvrVariantMap['e'].variantId ? 1 : '&nbsp;'" data-hvr-id="e" class="variantId index">1</th><th data-name="allele.hvrVariantMap['e'] != undefined && 2 == allele.hvrVariantMap['e'].variantId ? 2 : '&nbsp;'" data-hvr-id="e" class="variantId ">2</th><th data-name="allele.hvrVariantMap['e'] != undefined && 3 == allele.hvrVariantMap['e'].variantId ? 3 : '&nbsp;'" data-hvr-id="e" class="variantId ">3</th><th data-name="allele.hvrVariantMap['e'] != undefined && 4 == allele.hvrVariantMap['e'].variantId ? 4 : '&nbsp;'" data-hvr-id="e" class="variantId ">4</th><th data-name="allele.hvrVariantMap['e'] != undefined && 5 == allele.hvrVariantMap['e'].variantId ? 5 : '&nbsp;'" data-hvr-id="e" class="variantId ">5</th><th data-name="allele.hvrVariantMap['e'] != undefined && 6 == allele.hvrVariantMap['e'].variantId ? 6 : '&nbsp;'" data-hvr-id="e" class="variantId ">6</th>
                    <th data-name="allele.hvrVariantMap['e'] != undefined && allele.hvrVariantMap['e'].variantId.match(/[A-Z]+/) ? allele.hvrVariantMap['e'].variantId : '&nbsp;'" data-hvr-id="e" class="variantId indexRight"}">n/a</th>
                <th data-name="allele.hvrVariantMap['f'] != undefined && 1 == allele.hvrVariantMap['f'].variantId ? 1 : '&nbsp;'" data-hvr-id="f" class="variantId index">1</th><th data-name="allele.hvrVariantMap['f'] != undefined && 2 == allele.hvrVariantMap['f'].variantId ? 2 : '&nbsp;'" data-hvr-id="f" class="variantId ">2</th><th data-name="allele.hvrVariantMap['f'] != undefined && 3 == allele.hvrVariantMap['f'].variantId ? 3 : '&nbsp;'" data-hvr-id="f" class="variantId ">3</th><th data-name="allele.hvrVariantMap['f'] != undefined && 4 == allele.hvrVariantMap['f'].variantId ? 4 : '&nbsp;'" data-hvr-id="f" class="variantId ">4</th><th data-name="allele.hvrVariantMap['f'] != undefined && 5 == allele.hvrVariantMap['f'].variantId ? 5 : '&nbsp;'" data-hvr-id="f" class="variantId ">5</th><th data-name="allele.hvrVariantMap['f'] != undefined && 6 == allele.hvrVariantMap['f'].variantId ? 6 : '&nbsp;'" data-hvr-id="f" class="variantId ">6</th>
                    <th data-name="allele.hvrVariantMap['f'] != undefined && allele.hvrVariantMap['f'].variantId.match(/[A-Z]+/) ? allele.hvrVariantMap['f'].variantId : '&nbsp;'" data-hvr-id="f" class="variantId indexRight"}">n/a</th>
                <th data-name="allele.hvrVariantMap['g'] != undefined && 1 == allele.hvrVariantMap['g'].variantId ? 1 : '&nbsp;'" data-hvr-id="g" class="variantId index">1</th><th data-name="allele.hvrVariantMap['g'] != undefined && 2 == allele.hvrVariantMap['g'].variantId ? 2 : '&nbsp;'" data-hvr-id="g" class="variantId ">2</th><th data-name="allele.hvrVariantMap['g'] != undefined && 3 == allele.hvrVariantMap['g'].variantId ? 3 : '&nbsp;'" data-hvr-id="g" class="variantId ">3</th><th data-name="allele.hvrVariantMap['g'] != undefined && 4 == allele.hvrVariantMap['g'].variantId ? 4 : '&nbsp;'" data-hvr-id="g" class="variantId ">4</th><th data-name="allele.hvrVariantMap['g'] != undefined && 5 == allele.hvrVariantMap['g'].variantId ? 5 : '&nbsp;'" data-hvr-id="g" class="variantId ">5</th><th data-name="allele.hvrVariantMap['g'] != undefined && 6 == allele.hvrVariantMap['g'].variantId ? 6 : '&nbsp;'" data-hvr-id="g" class="variantId ">6</th>
                    <th data-name="allele.hvrVariantMap['g'] != undefined && allele.hvrVariantMap['g'].variantId.match(/[A-Z]+/) ? allele.hvrVariantMap['g'].variantId : '&nbsp;'" data-hvr-id="g" class="variantId indexRight"}">n/a</th>
            </tr>
            <tr id="hvrVariantSeqs" style="border: 1px solid black;">
                <th colspan="6" style="text-align: right;">protein sequence(s) &Longrightarrow;</th>
                <th data-name="hvrMap['a'].variantMap['1'] == undefined ? '&nbsp;' : hvrMap['a'].variantMap['1'].proteinSequenceList.join('<br/>')" data-hvr-id="a" class="variantSeq index"></th><th data-name="hvrMap['a'].variantMap['2'] == undefined ? '&nbsp;' : hvrMap['a'].variantMap['2'].proteinSequenceList.join('<br/>')" data-hvr-id="a" class="variantSeq "></th><th data-name="hvrMap['a'].variantMap['3'] == undefined ? '&nbsp;' : hvrMap['a'].variantMap['3'].proteinSequenceList.join('<br/>')" data-hvr-id="a" class="variantSeq "></th><th data-name="hvrMap['a'].variantMap['4'] == undefined ? '&nbsp;' : hvrMap['a'].variantMap['4'].proteinSequenceList.join('<br/>')" data-hvr-id="a" class="variantSeq "></th><th data-name="hvrMap['a'].variantMap['5'] == undefined ? '&nbsp;' : hvrMap['a'].variantMap['5'].proteinSequenceList.join('<br/>')" data-hvr-id="a" class="variantSeq "></th><th data-name="hvrMap['a'].variantMap['6'] == undefined ? '&nbsp;' : hvrMap['a'].variantMap['6'].proteinSequenceList.join('<br/>')" data-hvr-id="a" class="variantSeq "></th><th data-hvr-id="a" class="variantSeq indexRight">&nbsp;</th>
                <th data-name="hvrMap['b'].variantMap['1'] == undefined ? '&nbsp;' : hvrMap['b'].variantMap['1'].proteinSequenceList.join('<br/>')" data-hvr-id="b" class="variantSeq index"></th><th data-name="hvrMap['b'].variantMap['2'] == undefined ? '&nbsp;' : hvrMap['b'].variantMap['2'].proteinSequenceList.join('<br/>')" data-hvr-id="b" class="variantSeq "></th><th data-name="hvrMap['b'].variantMap['3'] == undefined ? '&nbsp;' : hvrMap['b'].variantMap['3'].proteinSequenceList.join('<br/>')" data-hvr-id="b" class="variantSeq "></th><th data-name="hvrMap['b'].variantMap['4'] == undefined ? '&nbsp;' : hvrMap['b'].variantMap['4'].proteinSequenceList.join('<br/>')" data-hvr-id="b" class="variantSeq "></th><th data-name="hvrMap['b'].variantMap['5'] == undefined ? '&nbsp;' : hvrMap['b'].variantMap['5'].proteinSequenceList.join('<br/>')" data-hvr-id="b" class="variantSeq "></th><th data-name="hvrMap['b'].variantMap['6'] == undefined ? '&nbsp;' : hvrMap['b'].variantMap['6'].proteinSequenceList.join('<br/>')" data-hvr-id="b" class="variantSeq "></th><th data-hvr-id="b" class="variantSeq indexRight">&nbsp;</th>
                <th data-name="hvrMap['c'].variantMap['1'] == undefined ? '&nbsp;' : hvrMap['c'].variantMap['1'].proteinSequenceList.join('<br/>')" data-hvr-id="c" class="variantSeq index"></th><th data-name="hvrMap['c'].variantMap['2'] == undefined ? '&nbsp;' : hvrMap['c'].variantMap['2'].proteinSequenceList.join('<br/>')" data-hvr-id="c" class="variantSeq "></th><th data-name="hvrMap['c'].variantMap['3'] == undefined ? '&nbsp;' : hvrMap['c'].variantMap['3'].proteinSequenceList.join('<br/>')" data-hvr-id="c" class="variantSeq "></th><th data-name="hvrMap['c'].variantMap['4'] == undefined ? '&nbsp;' : hvrMap['c'].variantMap['4'].proteinSequenceList.join('<br/>')" data-hvr-id="c" class="variantSeq "></th><th data-name="hvrMap['c'].variantMap['5'] == undefined ? '&nbsp;' : hvrMap['c'].variantMap['5'].proteinSequenceList.join('<br/>')" data-hvr-id="c" class="variantSeq "></th><th data-name="hvrMap['c'].variantMap['6'] == undefined ? '&nbsp;' : hvrMap['c'].variantMap['6'].proteinSequenceList.join('<br/>')" data-hvr-id="c" class="variantSeq "></th><th data-hvr-id="c" class="variantSeq indexRight">&nbsp;</th>
                <th data-name="hvrMap['d'].variantMap['1'] == undefined ? '&nbsp;' : hvrMap['d'].variantMap['1'].proteinSequenceList.join('<br/>')" data-hvr-id="d" class="variantSeq index"></th><th data-name="hvrMap['d'].variantMap['2'] == undefined ? '&nbsp;' : hvrMap['d'].variantMap['2'].proteinSequenceList.join('<br/>')" data-hvr-id="d" class="variantSeq "></th><th data-name="hvrMap['d'].variantMap['3'] == undefined ? '&nbsp;' : hvrMap['d'].variantMap['3'].proteinSequenceList.join('<br/>')" data-hvr-id="d" class="variantSeq "></th><th data-name="hvrMap['d'].variantMap['4'] == undefined ? '&nbsp;' : hvrMap['d'].variantMap['4'].proteinSequenceList.join('<br/>')" data-hvr-id="d" class="variantSeq "></th><th data-name="hvrMap['d'].variantMap['5'] == undefined ? '&nbsp;' : hvrMap['d'].variantMap['5'].proteinSequenceList.join('<br/>')" data-hvr-id="d" class="variantSeq "></th><th data-name="hvrMap['d'].variantMap['6'] == undefined ? '&nbsp;' : hvrMap['d'].variantMap['6'].proteinSequenceList.join('<br/>')" data-hvr-id="d" class="variantSeq "></th><th data-hvr-id="d" class="variantSeq indexRight">&nbsp;</th>
                <th data-name="hvrMap['e'].variantMap['1'] == undefined ? '&nbsp;' : hvrMap['e'].variantMap['1'].proteinSequenceList.join('<br/>')" data-hvr-id="e" class="variantSeq index"></th><th data-name="hvrMap['e'].variantMap['2'] == undefined ? '&nbsp;' : hvrMap['e'].variantMap['2'].proteinSequenceList.join('<br/>')" data-hvr-id="e" class="variantSeq "></th><th data-name="hvrMap['e'].variantMap['3'] == undefined ? '&nbsp;' : hvrMap['e'].variantMap['3'].proteinSequenceList.join('<br/>')" data-hvr-id="e" class="variantSeq "></th><th data-name="hvrMap['e'].variantMap['4'] == undefined ? '&nbsp;' : hvrMap['e'].variantMap['4'].proteinSequenceList.join('<br/>')" data-hvr-id="e" class="variantSeq "></th><th data-name="hvrMap['e'].variantMap['5'] == undefined ? '&nbsp;' : hvrMap['e'].variantMap['5'].proteinSequenceList.join('<br/>')" data-hvr-id="e" class="variantSeq "></th><th data-name="hvrMap['e'].variantMap['6'] == undefined ? '&nbsp;' : hvrMap['e'].variantMap['6'].proteinSequenceList.join('<br/>')" data-hvr-id="e" class="variantSeq "></th><th data-hvr-id="e" class="variantSeq indexRight">&nbsp;</th>
                <th data-name="hvrMap['f'].variantMap['1'] == undefined ? '&nbsp;' : hvrMap['f'].variantMap['1'].proteinSequenceList.join('<br/>')" data-hvr-id="f" class="variantSeq index"></th><th data-name="hvrMap['f'].variantMap['2'] == undefined ? '&nbsp;' : hvrMap['f'].variantMap['2'].proteinSequenceList.join('<br/>')" data-hvr-id="f" class="variantSeq "></th><th data-name="hvrMap['f'].variantMap['3'] == undefined ? '&nbsp;' : hvrMap['f'].variantMap['3'].proteinSequenceList.join('<br/>')" data-hvr-id="f" class="variantSeq "></th><th data-name="hvrMap['f'].variantMap['4'] == undefined ? '&nbsp;' : hvrMap['f'].variantMap['4'].proteinSequenceList.join('<br/>')" data-hvr-id="f" class="variantSeq "></th><th data-name="hvrMap['f'].variantMap['5'] == undefined ? '&nbsp;' : hvrMap['f'].variantMap['5'].proteinSequenceList.join('<br/>')" data-hvr-id="f" class="variantSeq "></th><th data-name="hvrMap['f'].variantMap['6'] == undefined ? '&nbsp;' : hvrMap['f'].variantMap['6'].proteinSequenceList.join('<br/>')" data-hvr-id="f" class="variantSeq "></th><th data-hvr-id="f" class="variantSeq indexRight">&nbsp;</th>
                <th data-name="hvrMap['g'].variantMap['1'] == undefined ? '&nbsp;' : hvrMap['g'].variantMap['1'].proteinSequenceList.join('<br/>')" data-hvr-id="g" class="variantSeq index"></th><th data-name="hvrMap['g'].variantMap['2'] == undefined ? '&nbsp;' : hvrMap['g'].variantMap['2'].proteinSequenceList.join('<br/>')" data-hvr-id="g" class="variantSeq "></th><th data-name="hvrMap['g'].variantMap['3'] == undefined ? '&nbsp;' : hvrMap['g'].variantMap['3'].proteinSequenceList.join('<br/>')" data-hvr-id="g" class="variantSeq "></th><th data-name="hvrMap['g'].variantMap['4'] == undefined ? '&nbsp;' : hvrMap['g'].variantMap['4'].proteinSequenceList.join('<br/>')" data-hvr-id="g" class="variantSeq "></th><th data-name="hvrMap['g'].variantMap['5'] == undefined ? '&nbsp;' : hvrMap['g'].variantMap['5'].proteinSequenceList.join('<br/>')" data-hvr-id="g" class="variantSeq "></th><th data-name="hvrMap['g'].variantMap['6'] == undefined ? '&nbsp;' : hvrMap['g'].variantMap['6'].proteinSequenceList.join('<br/>')" data-hvr-id="g" class="variantSeq "></th><th data-hvr-id="g" class="variantSeq indexRight">&nbsp;</th>
            </tr>
            <tr id="hvrKnownReactiveEpitopes" style="border: 1px solid black;">
                <th colspan="6" style="text-align: right;">is recipient known to have an antibody for this epitope? &Longrightarrow;</th>
                <th data-name="hvrMap['a'].variantMap['1'].knownReactiveEpitopeForCompat" data-container="hvrMap['a'].variantMap['1']" data-hvr-id="a" class="knownReactiveEpitope index"><input type="checkbox"></th><th data-name="hvrMap['a'].variantMap['2'].knownReactiveEpitopeForCompat" data-container="hvrMap['a'].variantMap['2']" data-hvr-id="a" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['a'].variantMap['3'].knownReactiveEpitopeForCompat" data-container="hvrMap['a'].variantMap['3']" data-hvr-id="a" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['a'].variantMap['4'].knownReactiveEpitopeForCompat" data-container="hvrMap['a'].variantMap['4']" data-hvr-id="a" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['a'].variantMap['5'].knownReactiveEpitopeForCompat" data-container="hvrMap['a'].variantMap['5']" data-hvr-id="a" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['a'].variantMap['6'].knownReactiveEpitopeForCompat" data-container="hvrMap['a'].variantMap['6']" data-hvr-id="a" class="knownReactiveEpitope "><input type="checkbox"></th><th data-hvr-id="a" class="knownReactiveEpitope indexRight">&nbsp;</th>
                <th data-name="hvrMap['b'].variantMap['1'].knownReactiveEpitopeForCompat" data-container="hvrMap['b'].variantMap['1']" data-hvr-id="b" class="knownReactiveEpitope index"><input type="checkbox"></th><th data-name="hvrMap['b'].variantMap['2'].knownReactiveEpitopeForCompat" data-container="hvrMap['b'].variantMap['2']" data-hvr-id="b" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['b'].variantMap['3'].knownReactiveEpitopeForCompat" data-container="hvrMap['b'].variantMap['3']" data-hvr-id="b" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['b'].variantMap['4'].knownReactiveEpitopeForCompat" data-container="hvrMap['b'].variantMap['4']" data-hvr-id="b" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['b'].variantMap['5'].knownReactiveEpitopeForCompat" data-container="hvrMap['b'].variantMap['5']" data-hvr-id="b" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['b'].variantMap['6'].knownReactiveEpitopeForCompat" data-container="hvrMap['b'].variantMap['6']" data-hvr-id="b" class="knownReactiveEpitope "><input type="checkbox"></th><th data-hvr-id="b" class="knownReactiveEpitope indexRight">&nbsp;</th>
                <th data-name="hvrMap['c'].variantMap['1'].knownReactiveEpitopeForCompat" data-container="hvrMap['c'].variantMap['1']" data-hvr-id="c" class="knownReactiveEpitope index"><input type="checkbox"></th><th data-name="hvrMap['c'].variantMap['2'].knownReactiveEpitopeForCompat" data-container="hvrMap['c'].variantMap['2']" data-hvr-id="c" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['c'].variantMap['3'].knownReactiveEpitopeForCompat" data-container="hvrMap['c'].variantMap['3']" data-hvr-id="c" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['c'].variantMap['4'].knownReactiveEpitopeForCompat" data-container="hvrMap['c'].variantMap['4']" data-hvr-id="c" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['c'].variantMap['5'].knownReactiveEpitopeForCompat" data-container="hvrMap['c'].variantMap['5']" data-hvr-id="c" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['c'].variantMap['6'].knownReactiveEpitopeForCompat" data-container="hvrMap['c'].variantMap['6']" data-hvr-id="c" class="knownReactiveEpitope "><input type="checkbox"></th><th data-hvr-id="c" class="knownReactiveEpitope indexRight">&nbsp;</th>
                <th data-name="hvrMap['d'].variantMap['1'].knownReactiveEpitopeForCompat" data-container="hvrMap['d'].variantMap['1']" data-hvr-id="d" class="knownReactiveEpitope index"><input type="checkbox"></th><th data-name="hvrMap['d'].variantMap['2'].knownReactiveEpitopeForCompat" data-container="hvrMap['d'].variantMap['2']" data-hvr-id="d" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['d'].variantMap['3'].knownReactiveEpitopeForCompat" data-container="hvrMap['d'].variantMap['3']" data-hvr-id="d" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['d'].variantMap['4'].knownReactiveEpitopeForCompat" data-container="hvrMap['d'].variantMap['4']" data-hvr-id="d" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['d'].variantMap['5'].knownReactiveEpitopeForCompat" data-container="hvrMap['d'].variantMap['5']" data-hvr-id="d" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['d'].variantMap['6'].knownReactiveEpitopeForCompat" data-container="hvrMap['d'].variantMap['6']" data-hvr-id="d" class="knownReactiveEpitope "><input type="checkbox"></th><th data-hvr-id="d" class="knownReactiveEpitope indexRight">&nbsp;</th>
                <th data-name="hvrMap['e'].variantMap['1'].knownReactiveEpitopeForCompat" data-container="hvrMap['e'].variantMap['1']" data-hvr-id="e" class="knownReactiveEpitope index"><input type="checkbox"></th><th data-name="hvrMap['e'].variantMap['2'].knownReactiveEpitopeForCompat" data-container="hvrMap['e'].variantMap['2']" data-hvr-id="e" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['e'].variantMap['3'].knownReactiveEpitopeForCompat" data-container="hvrMap['e'].variantMap['3']" data-hvr-id="e" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['e'].variantMap['4'].knownReactiveEpitopeForCompat" data-container="hvrMap['e'].variantMap['4']" data-hvr-id="e" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['e'].variantMap['5'].knownReactiveEpitopeForCompat" data-container="hvrMap['e'].variantMap['5']" data-hvr-id="e" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['e'].variantMap['6'].knownReactiveEpitopeForCompat" data-container="hvrMap['e'].variantMap['6']" data-hvr-id="e" class="knownReactiveEpitope "><input type="checkbox"></th><th data-hvr-id="e" class="knownReactiveEpitope indexRight">&nbsp;</th>
                <th data-name="hvrMap['f'].variantMap['1'].knownReactiveEpitopeForCompat" data-container="hvrMap['f'].variantMap['1']" data-hvr-id="f" class="knownReactiveEpitope index"><input type="checkbox"></th><th data-name="hvrMap['f'].variantMap['2'].knownReactiveEpitopeForCompat" data-container="hvrMap['f'].variantMap['2']" data-hvr-id="f" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['f'].variantMap['3'].knownReactiveEpitopeForCompat" data-container="hvrMap['f'].variantMap['3']" data-hvr-id="f" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['f'].variantMap['4'].knownReactiveEpitopeForCompat" data-container="hvrMap['f'].variantMap['4']" data-hvr-id="f" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['f'].variantMap['5'].knownReactiveEpitopeForCompat" data-container="hvrMap['f'].variantMap['5']" data-hvr-id="f" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['f'].variantMap['6'].knownReactiveEpitopeForCompat" data-container="hvrMap['f'].variantMap['6']" data-hvr-id="f" class="knownReactiveEpitope "><input type="checkbox"></th><th data-hvr-id="f" class="knownReactiveEpitope indexRight">&nbsp;</th>
                <th data-name="hvrMap['g'].variantMap['1'].knownReactiveEpitopeForCompat" data-container="hvrMap['g'].variantMap['1']" data-hvr-id="g" class="knownReactiveEpitope index"><input type="checkbox"></th><th data-name="hvrMap['g'].variantMap['2'].knownReactiveEpitopeForCompat" data-container="hvrMap['g'].variantMap['2']" data-hvr-id="g" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['g'].variantMap['3'].knownReactiveEpitopeForCompat" data-container="hvrMap['g'].variantMap['3']" data-hvr-id="g" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['g'].variantMap['4'].knownReactiveEpitopeForCompat" data-container="hvrMap['g'].variantMap['4']" data-hvr-id="g" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['g'].variantMap['5'].knownReactiveEpitopeForCompat" data-container="hvrMap['g'].variantMap['5']" data-hvr-id="g" class="knownReactiveEpitope "><input type="checkbox"></th><th data-name="hvrMap['g'].variantMap['6'].knownReactiveEpitopeForCompat" data-container="hvrMap['g'].variantMap['6']" data-hvr-id="g" class="knownReactiveEpitope "><input type="checkbox"></th><th data-hvr-id="g" class="knownReactiveEpitope indexRight">&nbsp;</th>
            </tr>
            <tr id="hvrRecipientEpitopes" style="border: 1px solid black;">
                <th colspan="6" style="text-align: right;">is this a recipient epitope? &Longrightarrow;</th>
                <th data-name="hvrMap['a'].variantMap['1'] != undefined && hvrMap['a'].variantMap['1'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="a" class="recipientEpitope index"></th><th data-name="hvrMap['a'].variantMap['2'] != undefined && hvrMap['a'].variantMap['2'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="a" class="recipientEpitope "></th><th data-name="hvrMap['a'].variantMap['3'] != undefined && hvrMap['a'].variantMap['3'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="a" class="recipientEpitope "></th><th data-name="hvrMap['a'].variantMap['4'] != undefined && hvrMap['a'].variantMap['4'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="a" class="recipientEpitope "></th><th data-name="hvrMap['a'].variantMap['5'] != undefined && hvrMap['a'].variantMap['5'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="a" class="recipientEpitope "></th><th data-name="hvrMap['a'].variantMap['6'] != undefined && hvrMap['a'].variantMap['6'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="a" class="recipientEpitope "></th><th data-hvr-id="a" class="recipientEpitope indexRight">&nbsp;</th>
                <th data-name="hvrMap['b'].variantMap['1'] != undefined && hvrMap['b'].variantMap['1'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="b" class="recipientEpitope index"></th><th data-name="hvrMap['b'].variantMap['2'] != undefined && hvrMap['b'].variantMap['2'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="b" class="recipientEpitope "></th><th data-name="hvrMap['b'].variantMap['3'] != undefined && hvrMap['b'].variantMap['3'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="b" class="recipientEpitope "></th><th data-name="hvrMap['b'].variantMap['4'] != undefined && hvrMap['b'].variantMap['4'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="b" class="recipientEpitope "></th><th data-name="hvrMap['b'].variantMap['5'] != undefined && hvrMap['b'].variantMap['5'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="b" class="recipientEpitope "></th><th data-name="hvrMap['b'].variantMap['6'] != undefined && hvrMap['b'].variantMap['6'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="b" class="recipientEpitope "></th><th data-hvr-id="b" class="recipientEpitope indexRight">&nbsp;</th>
                <th data-name="hvrMap['c'].variantMap['1'] != undefined && hvrMap['c'].variantMap['1'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="c" class="recipientEpitope index"></th><th data-name="hvrMap['c'].variantMap['2'] != undefined && hvrMap['c'].variantMap['2'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="c" class="recipientEpitope "></th><th data-name="hvrMap['c'].variantMap['3'] != undefined && hvrMap['c'].variantMap['3'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="c" class="recipientEpitope "></th><th data-name="hvrMap['c'].variantMap['4'] != undefined && hvrMap['c'].variantMap['4'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="c" class="recipientEpitope "></th><th data-name="hvrMap['c'].variantMap['5'] != undefined && hvrMap['c'].variantMap['5'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="c" class="recipientEpitope "></th><th data-name="hvrMap['c'].variantMap['6'] != undefined && hvrMap['c'].variantMap['6'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="c" class="recipientEpitope "></th><th data-hvr-id="c" class="recipientEpitope indexRight">&nbsp;</th>
                <th data-name="hvrMap['d'].variantMap['1'] != undefined && hvrMap['d'].variantMap['1'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="d" class="recipientEpitope index"></th><th data-name="hvrMap['d'].variantMap['2'] != undefined && hvrMap['d'].variantMap['2'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="d" class="recipientEpitope "></th><th data-name="hvrMap['d'].variantMap['3'] != undefined && hvrMap['d'].variantMap['3'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="d" class="recipientEpitope "></th><th data-name="hvrMap['d'].variantMap['4'] != undefined && hvrMap['d'].variantMap['4'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="d" class="recipientEpitope "></th><th data-name="hvrMap['d'].variantMap['5'] != undefined && hvrMap['d'].variantMap['5'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="d" class="recipientEpitope "></th><th data-name="hvrMap['d'].variantMap['6'] != undefined && hvrMap['d'].variantMap['6'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="d" class="recipientEpitope "></th><th data-hvr-id="d" class="recipientEpitope indexRight">&nbsp;</th>
                <th data-name="hvrMap['e'].variantMap['1'] != undefined && hvrMap['e'].variantMap['1'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="e" class="recipientEpitope index"></th><th data-name="hvrMap['e'].variantMap['2'] != undefined && hvrMap['e'].variantMap['2'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="e" class="recipientEpitope "></th><th data-name="hvrMap['e'].variantMap['3'] != undefined && hvrMap['e'].variantMap['3'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="e" class="recipientEpitope "></th><th data-name="hvrMap['e'].variantMap['4'] != undefined && hvrMap['e'].variantMap['4'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="e" class="recipientEpitope "></th><th data-name="hvrMap['e'].variantMap['5'] != undefined && hvrMap['e'].variantMap['5'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="e" class="recipientEpitope "></th><th data-name="hvrMap['e'].variantMap['6'] != undefined && hvrMap['e'].variantMap['6'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="e" class="recipientEpitope "></th><th data-hvr-id="e" class="recipientEpitope indexRight">&nbsp;</th>
                <th data-name="hvrMap['f'].variantMap['1'] != undefined && hvrMap['f'].variantMap['1'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="f" class="recipientEpitope index"></th><th data-name="hvrMap['f'].variantMap['2'] != undefined && hvrMap['f'].variantMap['2'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="f" class="recipientEpitope "></th><th data-name="hvrMap['f'].variantMap['3'] != undefined && hvrMap['f'].variantMap['3'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="f" class="recipientEpitope "></th><th data-name="hvrMap['f'].variantMap['4'] != undefined && hvrMap['f'].variantMap['4'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="f" class="recipientEpitope "></th><th data-name="hvrMap['f'].variantMap['5'] != undefined && hvrMap['f'].variantMap['5'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="f" class="recipientEpitope "></th><th data-name="hvrMap['f'].variantMap['6'] != undefined && hvrMap['f'].variantMap['6'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="f" class="recipientEpitope "></th><th data-hvr-id="f" class="recipientEpitope indexRight">&nbsp;</th>
                <th data-name="hvrMap['g'].variantMap['1'] != undefined && hvrMap['g'].variantMap['1'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="g" class="recipientEpitope index"></th><th data-name="hvrMap['g'].variantMap['2'] != undefined && hvrMap['g'].variantMap['2'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="g" class="recipientEpitope "></th><th data-name="hvrMap['g'].variantMap['3'] != undefined && hvrMap['g'].variantMap['3'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="g" class="recipientEpitope "></th><th data-name="hvrMap['g'].variantMap['4'] != undefined && hvrMap['g'].variantMap['4'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="g" class="recipientEpitope "></th><th data-name="hvrMap['g'].variantMap['5'] != undefined && hvrMap['g'].variantMap['5'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="g" class="recipientEpitope "></th><th data-name="hvrMap['g'].variantMap['6'] != undefined && hvrMap['g'].variantMap['6'].compatIsRecipientEpitope ? 'Y' : '&nbsp;'" data-hvr-id="g" class="recipientEpitope "></th><th data-hvr-id="g" class="recipientEpitope indexRight">&nbsp;</th>
            </tr>
            <tr id="hvrPctBeadsPositives" style="border: 1px solid black;">
                <th colspan="6" style="text-align: right;">percentage of single antigen beads positive &Longrightarrow;</th>
                <th data-name="hvrMap['a'].variantMap['1'] != undefined ? hvrMap['a'].variantMap['1'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="a" class="pctBeadsPositive index"></th><th data-name="hvrMap['a'].variantMap['2'] != undefined ? hvrMap['a'].variantMap['2'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="a" class="pctBeadsPositive "></th><th data-name="hvrMap['a'].variantMap['3'] != undefined ? hvrMap['a'].variantMap['3'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="a" class="pctBeadsPositive "></th><th data-name="hvrMap['a'].variantMap['4'] != undefined ? hvrMap['a'].variantMap['4'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="a" class="pctBeadsPositive "></th><th data-name="hvrMap['a'].variantMap['5'] != undefined ? hvrMap['a'].variantMap['5'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="a" class="pctBeadsPositive "></th><th data-name="hvrMap['a'].variantMap['6'] != undefined ? hvrMap['a'].variantMap['6'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="a" class="pctBeadsPositive "></th><th data-hvr-id="a" class="pctBeadsPositive indexRight">&nbsp;</th>
                <th data-name="hvrMap['b'].variantMap['1'] != undefined ? hvrMap['b'].variantMap['1'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="b" class="pctBeadsPositive index"></th><th data-name="hvrMap['b'].variantMap['2'] != undefined ? hvrMap['b'].variantMap['2'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="b" class="pctBeadsPositive "></th><th data-name="hvrMap['b'].variantMap['3'] != undefined ? hvrMap['b'].variantMap['3'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="b" class="pctBeadsPositive "></th><th data-name="hvrMap['b'].variantMap['4'] != undefined ? hvrMap['b'].variantMap['4'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="b" class="pctBeadsPositive "></th><th data-name="hvrMap['b'].variantMap['5'] != undefined ? hvrMap['b'].variantMap['5'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="b" class="pctBeadsPositive "></th><th data-name="hvrMap['b'].variantMap['6'] != undefined ? hvrMap['b'].variantMap['6'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="b" class="pctBeadsPositive "></th><th data-hvr-id="b" class="pctBeadsPositive indexRight">&nbsp;</th>
                <th data-name="hvrMap['c'].variantMap['1'] != undefined ? hvrMap['c'].variantMap['1'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="c" class="pctBeadsPositive index"></th><th data-name="hvrMap['c'].variantMap['2'] != undefined ? hvrMap['c'].variantMap['2'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="c" class="pctBeadsPositive "></th><th data-name="hvrMap['c'].variantMap['3'] != undefined ? hvrMap['c'].variantMap['3'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="c" class="pctBeadsPositive "></th><th data-name="hvrMap['c'].variantMap['4'] != undefined ? hvrMap['c'].variantMap['4'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="c" class="pctBeadsPositive "></th><th data-name="hvrMap['c'].variantMap['5'] != undefined ? hvrMap['c'].variantMap['5'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="c" class="pctBeadsPositive "></th><th data-name="hvrMap['c'].variantMap['6'] != undefined ? hvrMap['c'].variantMap['6'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="c" class="pctBeadsPositive "></th><th data-hvr-id="c" class="pctBeadsPositive indexRight">&nbsp;</th>
                <th data-name="hvrMap['d'].variantMap['1'] != undefined ? hvrMap['d'].variantMap['1'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="d" class="pctBeadsPositive index"></th><th data-name="hvrMap['d'].variantMap['2'] != undefined ? hvrMap['d'].variantMap['2'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="d" class="pctBeadsPositive "></th><th data-name="hvrMap['d'].variantMap['3'] != undefined ? hvrMap['d'].variantMap['3'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="d" class="pctBeadsPositive "></th><th data-name="hvrMap['d'].variantMap['4'] != undefined ? hvrMap['d'].variantMap['4'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="d" class="pctBeadsPositive "></th><th data-name="hvrMap['d'].variantMap['5'] != undefined ? hvrMap['d'].variantMap['5'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="d" class="pctBeadsPositive "></th><th data-name="hvrMap['d'].variantMap['6'] != undefined ? hvrMap['d'].variantMap['6'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="d" class="pctBeadsPositive "></th><th data-hvr-id="d" class="pctBeadsPositive indexRight">&nbsp;</th>
                <th data-name="hvrMap['e'].variantMap['1'] != undefined ? hvrMap['e'].variantMap['1'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="e" class="pctBeadsPositive index"></th><th data-name="hvrMap['e'].variantMap['2'] != undefined ? hvrMap['e'].variantMap['2'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="e" class="pctBeadsPositive "></th><th data-name="hvrMap['e'].variantMap['3'] != undefined ? hvrMap['e'].variantMap['3'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="e" class="pctBeadsPositive "></th><th data-name="hvrMap['e'].variantMap['4'] != undefined ? hvrMap['e'].variantMap['4'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="e" class="pctBeadsPositive "></th><th data-name="hvrMap['e'].variantMap['5'] != undefined ? hvrMap['e'].variantMap['5'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="e" class="pctBeadsPositive "></th><th data-name="hvrMap['e'].variantMap['6'] != undefined ? hvrMap['e'].variantMap['6'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="e" class="pctBeadsPositive "></th><th data-hvr-id="e" class="pctBeadsPositive indexRight">&nbsp;</th>
                <th data-name="hvrMap['f'].variantMap['1'] != undefined ? hvrMap['f'].variantMap['1'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="f" class="pctBeadsPositive index"></th><th data-name="hvrMap['f'].variantMap['2'] != undefined ? hvrMap['f'].variantMap['2'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="f" class="pctBeadsPositive "></th><th data-name="hvrMap['f'].variantMap['3'] != undefined ? hvrMap['f'].variantMap['3'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="f" class="pctBeadsPositive "></th><th data-name="hvrMap['f'].variantMap['4'] != undefined ? hvrMap['f'].variantMap['4'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="f" class="pctBeadsPositive "></th><th data-name="hvrMap['f'].variantMap['5'] != undefined ? hvrMap['f'].variantMap['5'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="f" class="pctBeadsPositive "></th><th data-name="hvrMap['f'].variantMap['6'] != undefined ? hvrMap['f'].variantMap['6'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="f" class="pctBeadsPositive "></th><th data-hvr-id="f" class="pctBeadsPositive indexRight">&nbsp;</th>
                <th data-name="hvrMap['g'].variantMap['1'] != undefined ? hvrMap['g'].variantMap['1'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="g" class="pctBeadsPositive index"></th><th data-name="hvrMap['g'].variantMap['2'] != undefined ? hvrMap['g'].variantMap['2'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="g" class="pctBeadsPositive "></th><th data-name="hvrMap['g'].variantMap['3'] != undefined ? hvrMap['g'].variantMap['3'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="g" class="pctBeadsPositive "></th><th data-name="hvrMap['g'].variantMap['4'] != undefined ? hvrMap['g'].variantMap['4'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="g" class="pctBeadsPositive "></th><th data-name="hvrMap['g'].variantMap['5'] != undefined ? hvrMap['g'].variantMap['5'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="g" class="pctBeadsPositive "></th><th data-name="hvrMap['g'].variantMap['6'] != undefined ? hvrMap['g'].variantMap['6'].compatPositiveSabPct : '&nbsp;'" data-hvr-id="g" class="pctBeadsPositive "></th><th data-hvr-id="g" class="pctBeadsPositive indexRight">&nbsp;</th>
            </tr>
            <tr id="hvrAntibodyPresents" style="border: 1px solid black;">
                <th colspan="6" style="text-align: right;">is an antibody for this epitope considered present? &Longrightarrow;</th>
                <th data-name="hvrMap['a'].variantMap['1'] != undefined && hvrMap['a'].variantMap['1'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="a" class="antibodyPresent index"></th><th data-name="hvrMap['a'].variantMap['2'] != undefined && hvrMap['a'].variantMap['2'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="a" class="antibodyPresent "></th><th data-name="hvrMap['a'].variantMap['3'] != undefined && hvrMap['a'].variantMap['3'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="a" class="antibodyPresent "></th><th data-name="hvrMap['a'].variantMap['4'] != undefined && hvrMap['a'].variantMap['4'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="a" class="antibodyPresent "></th><th data-name="hvrMap['a'].variantMap['5'] != undefined && hvrMap['a'].variantMap['5'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="a" class="antibodyPresent "></th><th data-name="hvrMap['a'].variantMap['6'] != undefined && hvrMap['a'].variantMap['6'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="a" class="antibodyPresent "></th><th data-hvr-id="a" class="antibodyPresent indexRight">&nbsp;</th>
                <th data-name="hvrMap['b'].variantMap['1'] != undefined && hvrMap['b'].variantMap['1'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="b" class="antibodyPresent index"></th><th data-name="hvrMap['b'].variantMap['2'] != undefined && hvrMap['b'].variantMap['2'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="b" class="antibodyPresent "></th><th data-name="hvrMap['b'].variantMap['3'] != undefined && hvrMap['b'].variantMap['3'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="b" class="antibodyPresent "></th><th data-name="hvrMap['b'].variantMap['4'] != undefined && hvrMap['b'].variantMap['4'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="b" class="antibodyPresent "></th><th data-name="hvrMap['b'].variantMap['5'] != undefined && hvrMap['b'].variantMap['5'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="b" class="antibodyPresent "></th><th data-name="hvrMap['b'].variantMap['6'] != undefined && hvrMap['b'].variantMap['6'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="b" class="antibodyPresent "></th><th data-hvr-id="b" class="antibodyPresent indexRight">&nbsp;</th>
                <th data-name="hvrMap['c'].variantMap['1'] != undefined && hvrMap['c'].variantMap['1'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="c" class="antibodyPresent index"></th><th data-name="hvrMap['c'].variantMap['2'] != undefined && hvrMap['c'].variantMap['2'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="c" class="antibodyPresent "></th><th data-name="hvrMap['c'].variantMap['3'] != undefined && hvrMap['c'].variantMap['3'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="c" class="antibodyPresent "></th><th data-name="hvrMap['c'].variantMap['4'] != undefined && hvrMap['c'].variantMap['4'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="c" class="antibodyPresent "></th><th data-name="hvrMap['c'].variantMap['5'] != undefined && hvrMap['c'].variantMap['5'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="c" class="antibodyPresent "></th><th data-name="hvrMap['c'].variantMap['6'] != undefined && hvrMap['c'].variantMap['6'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="c" class="antibodyPresent "></th><th data-hvr-id="c" class="antibodyPresent indexRight">&nbsp;</th>
                <th data-name="hvrMap['d'].variantMap['1'] != undefined && hvrMap['d'].variantMap['1'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="d" class="antibodyPresent index"></th><th data-name="hvrMap['d'].variantMap['2'] != undefined && hvrMap['d'].variantMap['2'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="d" class="antibodyPresent "></th><th data-name="hvrMap['d'].variantMap['3'] != undefined && hvrMap['d'].variantMap['3'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="d" class="antibodyPresent "></th><th data-name="hvrMap['d'].variantMap['4'] != undefined && hvrMap['d'].variantMap['4'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="d" class="antibodyPresent "></th><th data-name="hvrMap['d'].variantMap['5'] != undefined && hvrMap['d'].variantMap['5'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="d" class="antibodyPresent "></th><th data-name="hvrMap['d'].variantMap['6'] != undefined && hvrMap['d'].variantMap['6'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="d" class="antibodyPresent "></th><th data-hvr-id="d" class="antibodyPresent indexRight">&nbsp;</th>
                <th data-name="hvrMap['e'].variantMap['1'] != undefined && hvrMap['e'].variantMap['1'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="e" class="antibodyPresent index"></th><th data-name="hvrMap['e'].variantMap['2'] != undefined && hvrMap['e'].variantMap['2'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="e" class="antibodyPresent "></th><th data-name="hvrMap['e'].variantMap['3'] != undefined && hvrMap['e'].variantMap['3'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="e" class="antibodyPresent "></th><th data-name="hvrMap['e'].variantMap['4'] != undefined && hvrMap['e'].variantMap['4'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="e" class="antibodyPresent "></th><th data-name="hvrMap['e'].variantMap['5'] != undefined && hvrMap['e'].variantMap['5'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="e" class="antibodyPresent "></th><th data-name="hvrMap['e'].variantMap['6'] != undefined && hvrMap['e'].variantMap['6'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="e" class="antibodyPresent "></th><th data-hvr-id="e" class="antibodyPresent indexRight">&nbsp;</th>
                <th data-name="hvrMap['f'].variantMap['1'] != undefined && hvrMap['f'].variantMap['1'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="f" class="antibodyPresent index"></th><th data-name="hvrMap['f'].variantMap['2'] != undefined && hvrMap['f'].variantMap['2'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="f" class="antibodyPresent "></th><th data-name="hvrMap['f'].variantMap['3'] != undefined && hvrMap['f'].variantMap['3'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="f" class="antibodyPresent "></th><th data-name="hvrMap['f'].variantMap['4'] != undefined && hvrMap['f'].variantMap['4'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="f" class="antibodyPresent "></th><th data-name="hvrMap['f'].variantMap['5'] != undefined && hvrMap['f'].variantMap['5'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="f" class="antibodyPresent "></th><th data-name="hvrMap['f'].variantMap['6'] != undefined && hvrMap['f'].variantMap['6'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="f" class="antibodyPresent "></th><th data-hvr-id="f" class="antibodyPresent indexRight">&nbsp;</th>
                <th data-name="hvrMap['g'].variantMap['1'] != undefined && hvrMap['g'].variantMap['1'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="g" class="antibodyPresent index"></th><th data-name="hvrMap['g'].variantMap['2'] != undefined && hvrMap['g'].variantMap['2'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="g" class="antibodyPresent "></th><th data-name="hvrMap['g'].variantMap['3'] != undefined && hvrMap['g'].variantMap['3'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="g" class="antibodyPresent "></th><th data-name="hvrMap['g'].variantMap['4'] != undefined && hvrMap['g'].variantMap['4'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="g" class="antibodyPresent "></th><th data-name="hvrMap['g'].variantMap['5'] != undefined && hvrMap['g'].variantMap['5'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="g" class="antibodyPresent "></th><th data-name="hvrMap['g'].variantMap['6'] != undefined && hvrMap['g'].variantMap['6'].compatAntibodyConsideredPresent ? 'Y' : '&nbsp;'" data-hvr-id="g" class="antibodyPresent "></th><th data-hvr-id="g" class="antibodyPresent indexRight">&nbsp;</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
        
    <p><br/>Copyright &copy; 2018, Geoffrey H. Smith, MD

</body>

</html>

<script>

var page = 1;
var pageSize = 50;

var sessionId;
var reagentLotNumber; // the single antigen bead reagent lot number
var alleles = []; // the array of alleles
var hypervariableRegions = []; // the array of hypervariableRegions
var hvrMap = new Object(); // a map of hypervariable regions, indexed by hypervariable region ID
var sabOnly = false; // only show single antigen bead alleles
var selectedOnly = false; // only show donor type alleles or recipient type alleles or recipient antibody alleles
var statusSortMap = {
    'NEI': { sequence: 3 },
    'EI': { sequence: 2 },
    'I':  { sequence: 1 },
    'AA': { sequence: 0 }
}

function getSessionId() {
    $("#working").show();
    return $.ajax({
        url: "/hladpb1/resources/session",
        dataType: "text"
    }).then(function(response) {
        sessionId = response;
    });
}

function resetSession() {
    $("#working").show();
    return $.ajax({
        url: "/hladpb1/resources/session/reset",
        dataType: "json",
        type: "PUT",
        contentType: "application/json"
    });
}

// Get reagent lot number.
function getReagentLotNumber() {
    $("#working").show();
    return $.ajax({
        url: "/hladpb1/resources/hypervariableRegions/reagentLotNumber",
        dataType: "text"
    }).then(function(response) {
        reagentLotNumber = response;
    });
}

// Get all hypervariable regions.
function getHypervariableRegions() {
    $("#working").show();
    return $.ajax({
        url: "/hladpb1/resources/hypervariableRegions",
        dataType: "json"
    }).then(function(response) {
        hypervariableRegions = response;
        hypervariableRegions.forEach(function(hypervariableRegion) {
            hvrMap[hypervariableRegion.hypervariableRegionName] = hypervariableRegion;
        });
    });
}

// Put a hypervariable region (updates known reactive epitope attribute).
function putHypervariableRegion(hypervariableRegion) {
    $("#working").show();
    return $.ajax({
        url: "/hladpb1/resources/hypervariableRegions/" + hypervariableRegion.hypervariableRegionName,
        dataType: "json",
        type: "PUT",
        contentType: "application/json",
        data: JSON.stringify(hypervariableRegion)
    });
}

// Get all alleles.
function getAlleles() {
    $("#working").show();
    return $.ajax({
        url: "/hladpb1/resources/alleles?noCodons=true&synonymous=false", // always filter out synonymous alleles
        dataType: "json"
    }).then(function(response) {
        alleles = response;
    });
}

// Put an allele (updates donor type, recipient type, and recipient antibodies).
function putAllele(allele) {
    $("#working").show();
    return $.ajax({
        url: "/hladpb1/resources/alleles/" + allele.alleleName + "?noCodons=true",
        dataType: "json",
        type: "PUT",
        contentType: "application/json",
        data: JSON.stringify(allele)
    });
}

// Populate rows in the report table from the alleles array.
function populateTableRows() {
    $("#working").show();
    $("#reportTable tbody tr").remove();
    var rowHtml = [];
    var rowNumber = 0;
    alleles.forEach(function(allele) {
        if(!isRowVisible(allele)) {
            return;
        }
        if((rowNumber >= ((page - 1)) * pageSize) && rowNumber < (page * pageSize)) {
            rowHtml.push("<tr data-value='" + allele.alleleName + "' data-sequence='" + allele.sequenceNumber + "' " + (!isRowVisible(allele) ? "style='display: none;'" : "") + ">");
            $("#columnNames th").each(function() {
                var name = $(this).data("name");
                if($(this).hasClass("hvrId")) {
                    $("#hvrVariantIds th.variantId[data-hvr-id='" + $(this).data("hvr-id") + "']").each(function() {
                        var val = eval($(this).data("name"));
                        var tagAttributes = $(this)[0].outerHTML;
                        tagAttributes = tagAttributes.substring(4, tagAttributes.indexOf(">"));
                        rowHtml.push("<td " + tagAttributes + ">" + (val == undefined ? "&nbsp;" : val) + "</td>");
                    });
                }
                else if(name.match(/.*ForCompat/)) {
                    var val = eval($(this).data("name"));
                    var tagAttributes = $(this)[0].outerHTML;
                    tagAttributes = tagAttributes.substring(4, tagAttributes.indexOf(">"));
                    rowHtml.push("<td " + tagAttributes + "><input type='checkbox'>" + $(this).data("label") + "</td>");

                }
                else {
                    var val = eval(name);
                    var tagAttributes = $(this)[0].outerHTML;
                    tagAttributes = tagAttributes.substring(4, tagAttributes.indexOf(">"));
                    rowHtml.push("<td " + tagAttributes + ">" + (val == undefined ? "&nbsp;" : val) + "</td>");
                }
            });
            rowHtml.push("</tr>");
        }
        rowNumber++;
    });
    $("#reportTable tbody").append(rowHtml.join(""));
}

// Set the UI state based on the hypervariable region matches.
function setUiState() {
    var dfr = $.Deferred();
    $("#working").show();
    setTimeout(function() {
        $("#selectPage").html(""); for(var x = 1; x <= (Math.ceil(alleles.filter(isRowVisible).length / pageSize)); x++) { $("#selectPage").append("<option " + (x == page ? "selected='true'" : "") + ">" + x + "</option>"); }
        $("#inputPageSize").val(pageSize);
        populateTableRows();
        $("#sessionId").html(sessionId);
        $("#imgtDbVersion").html(alleles[0].version);
        $("#reagentLotNumber").html(reagentLotNumber);
        $("#sabFilter").removeClass("filterEnabled");      if(sabOnly )     { $("#sabFilter").addClass("filterEnabled"); }
        $("#selectedFilter").removeClass("filterEnabled"); if(selectedOnly) { $("#selectedFilter").addClass("filterEnabled"); }
        $("#hvrVariantSeqs th.variantSeq, #hvrRecipientEpitopes th.recipientEpitope, #hvrPctBeadsPositives th.pctBeadsPositive").each(function() {
            $(this).html(eval($(this).data("name")));
        });
        $("#reportTable th, #reportTable td").removeClass("mismatch");
        $("#hvrAntibodyPresents th.antibodyPresent").each(function() {
            var val = eval($(this).data("name"));
            $(this).html(val);
            if(val == "Y") {
                var colNo = $(this).parent().children().index($(this)) + 6;
                $(this).addClass("mismatch");
                $("#reportTable tbody tr > td:nth-child(" + colNo + ")").addClass("mismatch");
            }
        });
        $("#hvrKnownReactiveEpitopes th.knownReactiveEpitope").each(function() {
            $(this).children("input").prop("checked", eval($(this).data("container")) != undefined && eval($(this).data("name")));
        });
        $("#reportTable tbody tr").each(function() {
            var alleleName = $(this).data("value");
            var allele = alleles.find(function(allele) { return alleleName == allele.alleleName; });
            $(this).children("td").each(function() {
                if($(this).data("name").match(/.*ForCompat/)) {
                    $(this).children("input").prop("checked", eval($(this).data("name")));
                }
                if($(this).data("name") == "allele.compatInterpretation") {
                    $(this).html(eval($(this).data("name")));
                }
            });
        });
        dfr.resolve();
    }, 1);
    return dfr.promise();
}

// Row filtering function.
function isRowVisible(allele) {
    rowVisible = true;
    if(sabOnly && !allele.singleAntigenBead)                                                                               { rowVisible = false; }
    if(selectedOnly && !(allele.donorTypeForCompat || allele.recipientTypeForCompat || allele.recipientAntibodyForCompat)) { rowVisible = false; }
    return rowVisible;
}

// Sort function.
function alleleNameSort(a, b) {
    var A = a.sequenceNumber;
    var B = b.sequenceNumber;
    if(A < B)      { return -1; }
    else if(A > B) { return  1; }
    else           { return  0; }
};

// Sort function.
function statusSort(a, b) {
    var A = statusSortMap[a.compatInterpretation].sequence;
    var B = statusSortMap[b.compatInterpretation].sequence;
    if(A < B)      { return -1; }
    else if(A > B) { return  1; }
    else           { return alleleNameSort(a, b); }
}

// Document ready! Let's go...
$(document).ready(function() {

    // Initial population of report table.
    getSessionId().then(getReagentLotNumber).then(getHypervariableRegions).then(getAlleles).then(populateTableRows).then(setUiState).done(function() { $("#working").hide(); });

    $("#resetSessionLink").click(function() {
        resetSession().then(getSessionId).then(getReagentLotNumber).then(getHypervariableRegions).then(getAlleles).then(populateTableRows).then(setUiState).done(function() { $("#working").hide(); });
    });

    // Change a hypervariable region input (i.e., click a checkbox).
    $("#reportTable thead").on("change", "input", function() {
        var hvrId = $(this).parent().data("hvr-id");
        if(eval($(this).parent().data("container")) != undefined) {
            eval($(this).parent().data("name") + " = " + $(this).prop("checked"));
        }
        putHypervariableRegion(hvrMap[hvrId]).then(getHypervariableRegions).then(getAlleles).then(setUiState).done(function() { $("#working").hide(); } );
    });

    // Change an allele input (i.e., click a checkbox).
    $("#reportTable tbody").on("change", "input", function() {
        var alleleName = $(this).parents("tr").data("value");
        var allele = alleles.find(function(allele) { return alleleName == allele.alleleName; });
        eval($(this).parent().data("name") + " = " + $(this).prop("checked"));
        putAllele(allele).then(getHypervariableRegions).then(getAlleles).then(setUiState).done(function() { $("#working").hide(); } );
    });

    // Single antigen bead filter toggle on/off. This is handled locally.
    $("#sabFilter").click(function() {
        $("#working").show();
        setTimeout(function() {
            sabOnly = !sabOnly;
            page = 1;
            $("#selectPage").val(1);
            setUiState().done(function() { $("#working").hide(); });
        }, 1);
    });

    // Donor type or recipient type or recipient antibody filter toggle on/off.
    // This is handled locally.
    $("#selectedFilter").click(function() {
        $("#working").show();
        setTimeout(function() {
            selectedOnly = !selectedOnly;
            page = 1;
            $("#selectPage").val(1);
            setUiState().done(function() { $("#working").hide(); });
        }, 1);
    });

    // Click on sort. This is handled locally.
    $("#alleleNameSort").click(function() {
        $("#working").show();
        setTimeout(function() {
            alleles.sort(alleleNameSort);
            page = 1;
            $("#selectPage").val(1);
            setUiState().done(function() { $("#working").hide(); });
        }, 1);
    });
    
    // Click on sort. This is handled locally.
    $("#statusSort").click(function() {
        $("#working").show();
        setTimeout(function() {
            alleles.sort(statusSort);
            page = 1;
            $("#selectPage").val(1);
            setUiState().done(function() { $("#working").hide(); });
        }, 1);
    });

    $("#selectPage").change(function() {
        $("#working").show();
        setTimeout(function() {
            page = $("#selectPage").val();
            setUiState().done(function() { $("#working").hide(); });
        }, 1);
    });

    $("#linkPrevPage").click(function() {
        $("#working").show();
        setTimeout(function() {
            if(page > 1) {
                page--;
                $("#selectPage").val(page);
                setUiState().done(function() { $("#working").hide(); });
            }
            else {
                $("#working").hide();                
            }
        }, 1);
    });

    $("#linkNextPage").click(function() {
        $("#working").show();
        setTimeout(function() {
            if(page < Math.ceil(alleles.filter(isRowVisible).length / pageSize)) {
                page++;
                $("#selectPage").val(page);
                setUiState().done(function() { $("#working").hide(); });
            }
            else {
                $("#working").hide();                
            }
        }, 1);
    });

    $("#inputPageSize").change(function() {
        $("#working").show();
        setTimeout(function() {
            pageSize = $("#inputPageSize").val();
            page = 1;
            $("#selectPage").val(1);
            setUiState().done(function() { $("#working").hide(); });
        }, 1);
    });

});

</script>
